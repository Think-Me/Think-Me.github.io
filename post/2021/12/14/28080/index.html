<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>优化在4G网络环境差的地区中项目的响应速度 | Eber的小窝</title><meta name="author" content="eber"><meta name="copyright" content="eber"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="article">
<meta property="og:title" content="优化在4G网络环境差的地区中项目的响应速度">
<meta property="og:url" content="https://eber.vip/post/2021/12/14/28080/index.html">
<meta property="og:site_name" content="Eber的小窝">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://up.eber.vip/Think-Me/img/main/upload/http3.jpg">
<meta property="article:published_time" content="2021-12-14T10:11:23.000Z">
<meta property="article:modified_time" content="2021-12-14T10:11:23.000Z">
<meta property="article:author" content="eber">
<meta property="article:tag" content="HTTP3">
<meta property="article:tag" content="QUIC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://up.eber.vip/Think-Me/img/main/upload/http3.jpg"><link rel="shortcut icon" href="https://up.eber.vip/Think-Me/img/main/static/favicon.ico"><link rel="canonical" href="https://eber.vip/post/2021/12/14/28080/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><meta name="baidu-site-verification" content="codeva-RpsHAjsfoN"/><link rel="stylesheet" href="https://up.eber.vip/Think-Me/img/main/static/css/index.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.15/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-8820737714769485',
  enable_page_level_ads: 'true'
});</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?0d87231a10d73d7b43ff2dc95037cb9d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BWSGWCECKH"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-BWSGWCECKH');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.bootcdn.net/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdn.bootcdn.net/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '优化在4G网络环境差的地区中项目的响应速度',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-12-14 18:11:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://up.eber.vip/Think-Me/img/main/logo/eber.vip-modified.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Eber的小窝"><span class="site-name">Eber的小窝</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">优化在4G网络环境差的地区中项目的响应速度</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-14T10:11:23.000Z" title="发表于 2021-12-14 18:11:23">2021-12-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-14T10:11:23.000Z" title="更新于 2021-12-14 18:11:23">2021-12-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%89%E5%85%A8%E4%B8%8E%E8%BF%90%E7%BB%B4/">安全与运维</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>5分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title="优化在4G网络环境差的地区中项目的响应速度"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/post/2021/12/14/28080/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div><article class="post-content" id="article-container"><h2 id="1、背景简述"><a href="#1、背景简述" class="headerlink" title="1、背景简述"></a>1、背景简述</h2><p>最近做了一个网红街的商户收银系统：包含小商铺场景下用户微信扫码点餐H5、小程序、商家PAD点餐、排号、叫号、时间预测等，堂食多人扫桌码点餐、商家PAD点餐等。在前期的现场测试中发现该地区中国移动，中国电信4G、5G网络带宽低，抖动大。偶尔会出现用户端软件响应速度极慢。</p>
<h2 id="2、大致结构"><a href="#2、大致结构" class="headerlink" title="2、大致结构"></a>2、大致结构</h2><p><img src="https://up.eber.vip/Think-Me/img/main/upload/202304112229307.png" alt="项目结构.png"></p>
<h2 id="3、当前策略"><a href="#3、当前策略" class="headerlink" title="3、当前策略"></a>3、当前策略</h2><p><strong>目前全站接入HTTP&#x2F;2，目前服务器支持的技术如下：</strong></p>
<h4 id="1-、多路复用：代替掉HTTP1-x的序列和阻塞机制。同域名下所有通信都在单个连接上完成。单个连接可以承载任意数量的双向数据流。数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装。"><a href="#1-、多路复用：代替掉HTTP1-x的序列和阻塞机制。同域名下所有通信都在单个连接上完成。单个连接可以承载任意数量的双向数据流。数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装。" class="headerlink" title="(1)、多路复用：代替掉HTTP1.x的序列和阻塞机制。同域名下所有通信都在单个连接上完成。单个连接可以承载任意数量的双向数据流。数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装。"></a>(1)、多路复用：代替掉HTTP1.x的序列和阻塞机制。同域名下所有通信都在单个连接上完成。单个连接可以承载任意数量的双向数据流。数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装。</h4><p><img src="https://up.eber.vip/Think-Me/img/main/upload/2663160471.png" alt="chromef12.png"></p>
<h4 id="2-、Server-Push：HTTP-x2F-2-规范中引入的一种新技术，即服务端在没有被客户端明确的询问下，抢先地-“推送”-一些网站资源给客户端（浏览器），该特性可以极大的改善页面访问效果。"><a href="#2-、Server-Push：HTTP-x2F-2-规范中引入的一种新技术，即服务端在没有被客户端明确的询问下，抢先地-“推送”-一些网站资源给客户端（浏览器），该特性可以极大的改善页面访问效果。" class="headerlink" title="(2)、Server Push：HTTP&#x2F;2 规范中引入的一种新技术，即服务端在没有被客户端明确的询问下，抢先地 “推送” 一些网站资源给客户端（浏览器），该特性可以极大的改善页面访问效果。"></a>(2)、Server Push：HTTP&#x2F;2 规范中引入的一种新技术，即服务端在没有被客户端明确的询问下，抢先地 “推送” 一些网站资源给客户端（浏览器），该特性可以极大的改善页面访问效果。</h4><h4 id="3-、头部压缩：HTTP-x2F-2在客户端和服务器端使用“首部表”来跟踪和存储之前发送的键－值对，对于相同的数据，不再通过每次请求和响应发送；首部表在HTTP-x2F-2的连接存续期内始终存在，由客户端和服务器共同渐进地更新-每个新的首部键－值对要么被追加到当前表的末尾，要么替换表中之前的值。"><a href="#3-、头部压缩：HTTP-x2F-2在客户端和服务器端使用“首部表”来跟踪和存储之前发送的键－值对，对于相同的数据，不再通过每次请求和响应发送；首部表在HTTP-x2F-2的连接存续期内始终存在，由客户端和服务器共同渐进地更新-每个新的首部键－值对要么被追加到当前表的末尾，要么替换表中之前的值。" class="headerlink" title="(3)、头部压缩：HTTP&#x2F;2在客户端和服务器端使用“首部表”来跟踪和存储之前发送的键－值对，对于相同的数据，不再通过每次请求和响应发送；首部表在HTTP&#x2F;2的连接存续期内始终存在，由客户端和服务器共同渐进地更新;每个新的首部键－值对要么被追加到当前表的末尾，要么替换表中之前的值。"></a>(3)、头部压缩：HTTP&#x2F;2在客户端和服务器端使用“首部表”来跟踪和存储之前发送的键－值对，对于相同的数据，不再通过每次请求和响应发送；首部表在HTTP&#x2F;2的连接存续期内始终存在，由客户端和服务器共同渐进地更新;每个新的首部键－值对要么被追加到当前表的末尾，要么替换表中之前的值。</h4><h4 id="3-、WebP：Google推出的一种同时提供了有损压缩与无损压缩的图片文件格式。能最高将图片大小缩减90-左右，非常适合web图片使用。"><a href="#3-、WebP：Google推出的一种同时提供了有损压缩与无损压缩的图片文件格式。能最高将图片大小缩减90-左右，非常适合web图片使用。" class="headerlink" title="(3)、WebP：Google推出的一种同时提供了有损压缩与无损压缩的图片文件格式。能最高将图片大小缩减90%左右，非常适合web图片使用。"></a>(3)、WebP：Google推出的一种同时提供了有损压缩与无损压缩的图片文件格式。能最高将图片大小缩减90%左右，非常适合web图片使用。</h4><h4 id="4-、OCSP-装订缓存：服务器在-TLS-握手时会发送被缓存的OCSP响应，供用户验证，无需用户再向CA发送查询请求。极大地提高了-TLS-握手效率，节省了用户验证时间。"><a href="#4-、OCSP-装订缓存：服务器在-TLS-握手时会发送被缓存的OCSP响应，供用户验证，无需用户再向CA发送查询请求。极大地提高了-TLS-握手效率，节省了用户验证时间。" class="headerlink" title="(4)、OCSP 装订缓存：服务器在 TLS 握手时会发送被缓存的OCSP响应，供用户验证，无需用户再向CA发送查询请求。极大地提高了 TLS 握手效率，节省了用户验证时间。"></a>(4)、OCSP 装订缓存：服务器在 TLS 握手时会发送被缓存的OCSP响应，供用户验证，无需用户再向CA发送查询请求。极大地提高了 TLS 握手效率，节省了用户验证时间。</h4><h4 id="5-、CDN：采用第三方厂商CDN服务来处理静态资源和页面缓存，能在用户访问时通过最近最优的节点去返回缓存资源，大大的优化了资源在网络传输中的效率。"><a href="#5-、CDN：采用第三方厂商CDN服务来处理静态资源和页面缓存，能在用户访问时通过最近最优的节点去返回缓存资源，大大的优化了资源在网络传输中的效率。" class="headerlink" title="(5)、CDN：采用第三方厂商CDN服务来处理静态资源和页面缓存，能在用户访问时通过最近最优的节点去返回缓存资源，大大的优化了资源在网络传输中的效率。"></a>(5)、CDN：采用第三方厂商CDN服务来处理静态资源和页面缓存，能在用户访问时通过最近最优的节点去返回缓存资源，大大的优化了资源在网络传输中的效率。</h4><h2 id="4、优化方案"><a href="#4、优化方案" class="headerlink" title="4、优化方案"></a>4、优化方案</h2><p>理论上如上操作即可极大的增强用户体验，但是仅仅是能提升正常网络状态下的用户体验。而针对高延迟，抖动大的弱网络环境仅仅做到上述策略还不够。</p>
<p><strong>首先想到的是TCP和UDP两种协议的优缺点：</strong></p>
<p><strong>TCP：可靠、稳定，但是建连需要经过3次握手，相对繁琐、效率低且占用系统资源高。</strong></p>
<p><strong>UDP：效率高、快、轻量，占用系统资源较少，但是存在不可靠、无序等缺点。</strong></p>
<p>基于TCP和UDP的优缺点，<strong>Google</strong>制定了一种<strong>基于UDP</strong>的低时延的互联网传输层协议—–即<strong>QUIC</strong>（Quick UDP Internet Connection）</p>
<p>在看了多个互联网产品的（微博、网易云信等）QUIC 加速服务架构与实践文档后，决定对现有的测试环境服务做QUIC改造并现场进行测试。</p>
<p>现有的开源实现：<br>1、quiche：这个是用 Rust 做的库，通过nginx调用。【不是Google的quiche库】<br>2、ATS：Apache Traffic Server<br>3、golang：Caddy；<br>4、python+C，aioquic<br>5、微软msquic</p>
<p>考虑到通用性和性能，我们最终选择了基于go的Caddy server进行测试。</p>
<p>因为caddy的v1版本和v2版本的配置是不相通的，所以往上很多文章都是已经过时的，我们看看官网怎么说：</p>
<p><strong>For example, to configure different options for the servers on port :80 and :443, you would specify two servers blocks:</strong>[<a target="_blank" rel="noopener external nofollow noreferrer" href="https://caddyserver.com/docs/caddyfile/options#server-options">原文链接</a>]</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	servers :443 &#123;</span><br><span class="line">		protocol &#123;</span><br><span class="line">			experimental_http3</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	servers :80 &#123;</span><br><span class="line">		protocol &#123;</span><br><span class="line">			allow_h2c</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述servers :443代码块就是实现HTTP&#x2F;3（HTTP Over QUIC）的配置方式，示例中也提到了以明文方式传输HTTP&#x2F;2（即H2C –”Cleartext HTTP&#x2F;2” or “H2 over TCP”）的开启方式。</p>
<p>官网对这两个代码块也是有详细说明的：</p>
<p>allow_h2c：enables H2C (“Cleartext HTTP&#x2F;2” or “H2 over TCP”) support, which will serve HTTP&#x2F;2 over plaintext TCP connections if a client support it. Because this is not implemented by the Go standard library, using H2C is incompatible with most of the other options for this server. Do not enable this only to achieve maximum client compatibility. In practice, very few clients implement H2C, and even fewer require it. This setting applies only to unencrypted HTTP listeners. ⚠️ Experimental feature; subject to change or removal.<strong>（大概意思就是H2C实际上不会有人去用，此功能只是个实验性的功能，未来可能会更改或者删除。）</strong></p>
<p>experimental_http3：enables experimental draft HTTP&#x2F;3 support. Note that HTTP&#x2F;3 is not a finished spec and client support is extremely limited. This option will go away in the future. This option is not subject to compatibility promises.<strong>（大概意思是HTTP&#x2F;3不是完整的规范，客户端支持也有限。此选项未来会消失。也不受到兼容性承诺的约束。）</strong></p>
<p>我们在测试中只需要在servers块下创建protocol块，然后指定experimental_http3即可。<br>即：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	servers :443 &#123;</span><br><span class="line">		protocol &#123;</span><br><span class="line">			experimental_http3</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意⚠️ caddy的配置文件是按行区分的，是不带句尾分号的  ；</p>
<p>在实现HTTP&#x2F;3之后，我们使用多种设备和运营商卡进行了多次现场测试。原本在现场遇到弱网情况下需要7s左右才能Finish的页面现在仅仅需要2s。极大的提升了加载速度！</p>
<p>得到测试结论后，我们要做的就是线上生产环境的改造。这时一个新的问题摆在我们面前：<strong>腾讯云CDN不支持HTTP&#x2F;3。</strong></p>
<p>这里我们进行了讨论得出两种方案：<br>1、自建一个小型的CDN网络供这个服务使用。<br>2、使用支持HTTP&#x2F;3的CDN厂家。</p>
<p>第一个成本就比较高了，维护起来也比较麻烦。所以我们就选择了第二个方案，把这个服务接入到了支持HTTP&#x2F;3协议的CDN厂家。这里就不做推荐了，大家要善用搜索引擎。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://eber.vip">eber</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://eber.vip/post/2021/12/14/28080/">https://eber.vip/post/2021/12/14/28080/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://eber.vip" target="_blank">Eber的小窝</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/HTTP3/">HTTP3</a><a class="post-meta__tags" href="/tags/QUIC/">QUIC</a></div><div class="post_share"><div class="social-share" data-image="https://up.eber.vip/Think-Me/img/main/upload/http3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.bootcdn.net/ajax/libs/butterfly-extsrc/1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://up.eber.vip/Think-Me/img/main/2023/09/1695283278-202309211601651.png" target="_blank"><img class="post-qr-code-img" src="https://up.eber.vip/Think-Me/img/main/2023/09/1695283278-202309211601651.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://up.eber.vip/Think-Me/img/main/2023/09/1695283215-202309211600353.png" target="_blank"><img class="post-qr-code-img" src="https://up.eber.vip/Think-Me/img/main/2023/09/1695283215-202309211600353.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/2021/12/05/49759/" title="Nginx的动静态gzip压缩配置及参数详解"><img class="cover" src="https://up.eber.vip/Think-Me/img/main/upload/nginx.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Nginx的动静态gzip压缩配置及参数详解</div></div></a></div><div class="next-post pull-right"><a href="/post/2021/12/29/21421/" title="简单的聊一聊Redis"><img class="cover" src="https://up.eber.vip/Think-Me/img/main/upload/redis.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">简单的聊一聊Redis</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://up.eber.vip/Think-Me/img/main/logo/eber.vip-modified.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">eber</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/think-me" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:admin@office365.eber.vip" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">GPT页面已经被劫持到反诈中心了，停止服务！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E8%83%8C%E6%99%AF%E7%AE%80%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">1、背景简述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%A4%A7%E8%87%B4%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">2、大致结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%BD%93%E5%89%8D%E7%AD%96%E7%95%A5"><span class="toc-number">3.</span> <span class="toc-text">3、当前策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E3%80%81%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%EF%BC%9A%E4%BB%A3%E6%9B%BF%E6%8E%89HTTP1-x%E7%9A%84%E5%BA%8F%E5%88%97%E5%92%8C%E9%98%BB%E5%A1%9E%E6%9C%BA%E5%88%B6%E3%80%82%E5%90%8C%E5%9F%9F%E5%90%8D%E4%B8%8B%E6%89%80%E6%9C%89%E9%80%9A%E4%BF%A1%E9%83%BD%E5%9C%A8%E5%8D%95%E4%B8%AA%E8%BF%9E%E6%8E%A5%E4%B8%8A%E5%AE%8C%E6%88%90%E3%80%82%E5%8D%95%E4%B8%AA%E8%BF%9E%E6%8E%A5%E5%8F%AF%E4%BB%A5%E6%89%BF%E8%BD%BD%E4%BB%BB%E6%84%8F%E6%95%B0%E9%87%8F%E7%9A%84%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81%E3%80%82%E6%95%B0%E6%8D%AE%E6%B5%81%E4%BB%A5%E6%B6%88%E6%81%AF%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%8F%91%E9%80%81%EF%BC%8C%E8%80%8C%E6%B6%88%E6%81%AF%E5%8F%88%E7%94%B1%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E5%B8%A7%E7%BB%84%E6%88%90%EF%BC%8C%E5%A4%9A%E4%B8%AA%E5%B8%A7%E4%B9%8B%E9%97%B4%E5%8F%AF%E4%BB%A5%E4%B9%B1%E5%BA%8F%E5%8F%91%E9%80%81%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%A0%B9%E6%8D%AE%E5%B8%A7%E9%A6%96%E9%83%A8%E7%9A%84%E6%B5%81%E6%A0%87%E8%AF%86%E5%8F%AF%E4%BB%A5%E9%87%8D%E6%96%B0%E7%BB%84%E8%A3%85%E3%80%82"><span class="toc-number">3.0.1.</span> <span class="toc-text">(1)、多路复用：代替掉HTTP1.x的序列和阻塞机制。同域名下所有通信都在单个连接上完成。单个连接可以承载任意数量的双向数据流。数据流以消息的形式发送，而消息又由一个或多个帧组成，多个帧之间可以乱序发送，因为根据帧首部的流标识可以重新组装。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E3%80%81Server-Push%EF%BC%9AHTTP-x2F-2-%E8%A7%84%E8%8C%83%E4%B8%AD%E5%BC%95%E5%85%A5%E7%9A%84%E4%B8%80%E7%A7%8D%E6%96%B0%E6%8A%80%E6%9C%AF%EF%BC%8C%E5%8D%B3%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%9C%A8%E6%B2%A1%E6%9C%89%E8%A2%AB%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%98%8E%E7%A1%AE%E7%9A%84%E8%AF%A2%E9%97%AE%E4%B8%8B%EF%BC%8C%E6%8A%A2%E5%85%88%E5%9C%B0-%E2%80%9C%E6%8E%A8%E9%80%81%E2%80%9D-%E4%B8%80%E4%BA%9B%E7%BD%91%E7%AB%99%E8%B5%84%E6%BA%90%E7%BB%99%E5%AE%A2%E6%88%B7%E7%AB%AF%EF%BC%88%E6%B5%8F%E8%A7%88%E5%99%A8%EF%BC%89%EF%BC%8C%E8%AF%A5%E7%89%B9%E6%80%A7%E5%8F%AF%E4%BB%A5%E6%9E%81%E5%A4%A7%E7%9A%84%E6%94%B9%E5%96%84%E9%A1%B5%E9%9D%A2%E8%AE%BF%E9%97%AE%E6%95%88%E6%9E%9C%E3%80%82"><span class="toc-number">3.0.2.</span> <span class="toc-text">(2)、Server Push：HTTP&#x2F;2 规范中引入的一种新技术，即服务端在没有被客户端明确的询问下，抢先地 “推送” 一些网站资源给客户端（浏览器），该特性可以极大的改善页面访问效果。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E3%80%81%E5%A4%B4%E9%83%A8%E5%8E%8B%E7%BC%A9%EF%BC%9AHTTP-x2F-2%E5%9C%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E4%BD%BF%E7%94%A8%E2%80%9C%E9%A6%96%E9%83%A8%E8%A1%A8%E2%80%9D%E6%9D%A5%E8%B7%9F%E8%B8%AA%E5%92%8C%E5%AD%98%E5%82%A8%E4%B9%8B%E5%89%8D%E5%8F%91%E9%80%81%E7%9A%84%E9%94%AE%EF%BC%8D%E5%80%BC%E5%AF%B9%EF%BC%8C%E5%AF%B9%E4%BA%8E%E7%9B%B8%E5%90%8C%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%B8%8D%E5%86%8D%E9%80%9A%E8%BF%87%E6%AF%8F%E6%AC%A1%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E5%8F%91%E9%80%81%EF%BC%9B%E9%A6%96%E9%83%A8%E8%A1%A8%E5%9C%A8HTTP-x2F-2%E7%9A%84%E8%BF%9E%E6%8E%A5%E5%AD%98%E7%BB%AD%E6%9C%9F%E5%86%85%E5%A7%8B%E7%BB%88%E5%AD%98%E5%9C%A8%EF%BC%8C%E7%94%B1%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%85%B1%E5%90%8C%E6%B8%90%E8%BF%9B%E5%9C%B0%E6%9B%B4%E6%96%B0-%E6%AF%8F%E4%B8%AA%E6%96%B0%E7%9A%84%E9%A6%96%E9%83%A8%E9%94%AE%EF%BC%8D%E5%80%BC%E5%AF%B9%E8%A6%81%E4%B9%88%E8%A2%AB%E8%BF%BD%E5%8A%A0%E5%88%B0%E5%BD%93%E5%89%8D%E8%A1%A8%E7%9A%84%E6%9C%AB%E5%B0%BE%EF%BC%8C%E8%A6%81%E4%B9%88%E6%9B%BF%E6%8D%A2%E8%A1%A8%E4%B8%AD%E4%B9%8B%E5%89%8D%E7%9A%84%E5%80%BC%E3%80%82"><span class="toc-number">3.0.3.</span> <span class="toc-text">(3)、头部压缩：HTTP&#x2F;2在客户端和服务器端使用“首部表”来跟踪和存储之前发送的键－值对，对于相同的数据，不再通过每次请求和响应发送；首部表在HTTP&#x2F;2的连接存续期内始终存在，由客户端和服务器共同渐进地更新;每个新的首部键－值对要么被追加到当前表的末尾，要么替换表中之前的值。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E3%80%81WebP%EF%BC%9AGoogle%E6%8E%A8%E5%87%BA%E7%9A%84%E4%B8%80%E7%A7%8D%E5%90%8C%E6%97%B6%E6%8F%90%E4%BE%9B%E4%BA%86%E6%9C%89%E6%8D%9F%E5%8E%8B%E7%BC%A9%E4%B8%8E%E6%97%A0%E6%8D%9F%E5%8E%8B%E7%BC%A9%E7%9A%84%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E3%80%82%E8%83%BD%E6%9C%80%E9%AB%98%E5%B0%86%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F%E7%BC%A9%E5%87%8F90-%E5%B7%A6%E5%8F%B3%EF%BC%8C%E9%9D%9E%E5%B8%B8%E9%80%82%E5%90%88web%E5%9B%BE%E7%89%87%E4%BD%BF%E7%94%A8%E3%80%82"><span class="toc-number">3.0.4.</span> <span class="toc-text">(3)、WebP：Google推出的一种同时提供了有损压缩与无损压缩的图片文件格式。能最高将图片大小缩减90%左右，非常适合web图片使用。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E3%80%81OCSP-%E8%A3%85%E8%AE%A2%E7%BC%93%E5%AD%98%EF%BC%9A%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%A8-TLS-%E6%8F%A1%E6%89%8B%E6%97%B6%E4%BC%9A%E5%8F%91%E9%80%81%E8%A2%AB%E7%BC%93%E5%AD%98%E7%9A%84OCSP%E5%93%8D%E5%BA%94%EF%BC%8C%E4%BE%9B%E7%94%A8%E6%88%B7%E9%AA%8C%E8%AF%81%EF%BC%8C%E6%97%A0%E9%9C%80%E7%94%A8%E6%88%B7%E5%86%8D%E5%90%91CA%E5%8F%91%E9%80%81%E6%9F%A5%E8%AF%A2%E8%AF%B7%E6%B1%82%E3%80%82%E6%9E%81%E5%A4%A7%E5%9C%B0%E6%8F%90%E9%AB%98%E4%BA%86-TLS-%E6%8F%A1%E6%89%8B%E6%95%88%E7%8E%87%EF%BC%8C%E8%8A%82%E7%9C%81%E4%BA%86%E7%94%A8%E6%88%B7%E9%AA%8C%E8%AF%81%E6%97%B6%E9%97%B4%E3%80%82"><span class="toc-number">3.0.5.</span> <span class="toc-text">(4)、OCSP 装订缓存：服务器在 TLS 握手时会发送被缓存的OCSP响应，供用户验证，无需用户再向CA发送查询请求。极大地提高了 TLS 握手效率，节省了用户验证时间。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E3%80%81CDN%EF%BC%9A%E9%87%87%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8E%82%E5%95%86CDN%E6%9C%8D%E5%8A%A1%E6%9D%A5%E5%A4%84%E7%90%86%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%92%8C%E9%A1%B5%E9%9D%A2%E7%BC%93%E5%AD%98%EF%BC%8C%E8%83%BD%E5%9C%A8%E7%94%A8%E6%88%B7%E8%AE%BF%E9%97%AE%E6%97%B6%E9%80%9A%E8%BF%87%E6%9C%80%E8%BF%91%E6%9C%80%E4%BC%98%E7%9A%84%E8%8A%82%E7%82%B9%E5%8E%BB%E8%BF%94%E5%9B%9E%E7%BC%93%E5%AD%98%E8%B5%84%E6%BA%90%EF%BC%8C%E5%A4%A7%E5%A4%A7%E7%9A%84%E4%BC%98%E5%8C%96%E4%BA%86%E8%B5%84%E6%BA%90%E5%9C%A8%E7%BD%91%E7%BB%9C%E4%BC%A0%E8%BE%93%E4%B8%AD%E7%9A%84%E6%95%88%E7%8E%87%E3%80%82"><span class="toc-number">3.0.6.</span> <span class="toc-text">(5)、CDN：采用第三方厂商CDN服务来处理静态资源和页面缓存，能在用户访问时通过最近最优的节点去返回缓存资源，大大的优化了资源在网络传输中的效率。</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88"><span class="toc-number">4.</span> <span class="toc-text">4、优化方案</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/2024/01/02/33430/" title="解决使用GitHub Pages自定义域名后无法正常申请通配符证书的问题"><img src="/../img/acme/errorimg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="解决使用GitHub Pages自定义域名后无法正常申请通配符证书的问题"/></a><div class="content"><a class="title" href="/post/2024/01/02/33430/" title="解决使用GitHub Pages自定义域名后无法正常申请通配符证书的问题">解决使用GitHub Pages自定义域名后无法正常申请通配符证书的问题</a><time datetime="2024-01-02T12:23:55.000Z" title="发表于 2024-01-02 20:23:55">2024-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/2023/12/25/14212/" title="Overlay文件系统"><img src="/../img/Overlay%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/overlay.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Overlay文件系统"/></a><div class="content"><a class="title" href="/post/2023/12/25/14212/" title="Overlay文件系统">Overlay文件系统</a><time datetime="2023-12-25T09:29:36.000Z" title="发表于 2023-12-25 17:29:36">2023-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/2023/09/21/21181/" title="Mac上最强虚拟机Parallels Desktop破解版"><img src="https://up.eber.vip/Think-Me/img/main/2023/09/1695287042-202309211704100.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mac上最强虚拟机Parallels Desktop破解版"/></a><div class="content"><a class="title" href="/post/2023/09/21/21181/" title="Mac上最强虚拟机Parallels Desktop破解版">Mac上最强虚拟机Parallels Desktop破解版</a><time datetime="2023-09-21T12:06:32.000Z" title="发表于 2023-09-21 20:06:32">2023-09-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2024 By eber <a target="_blank" href="https://beian.miit.gov.cn" rel="external nofollow noreferrer">豫ICP备2021035851号-1</a></div><div class="footer_custom_text">本网站由 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral"><img src="https://up.eber.vip/Think-Me/img/main/upload/upyun.png" align="absmiddle" width="59px" height="30px"></a> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.cloudflare.com"><img src="https://up.eber.vip/Think-Me/img/main/upload/CF_logo_horizontal_whitetype.svg" align="absmiddle" width="100px" height="30px"></a> 联合提供加速服务</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.bootcdn.net/ajax/libs/hexo-theme-butterfly/4.8.1/js/utils.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/hexo-theme-butterfly/4.8.1/js/main.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.15/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://im.t.eber.vip',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://im.t.eber.vip',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.bootcdn.net/ajax/libs/twikoo/1.6.16/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer data-domain="eber.vip" src="https://pas.eber.vip/js/script.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/butterfly-extsrc/1.1.3/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="https://cdn.bootcdn.net/ajax/libs/hexo-theme-butterfly/4.8.1/js/search/local-search.min.js"></script></div></div></body></html>